Task,Status (guess),Customer files to update,Admin source of truth,Notes
Show + enforce per-class cancellation window (24h) with countdown and disable self-cancel after cutoff,Partially present,/src/components/portal/pages/ClassDetailPage.tsx; /src/components/portal/pages/AccountDashboardPage.tsx; /src/components/core/BookingEngine.tsx,/src/components/SettingsManagement.tsx; /src/utils/supabase/settings-service.ts; /src/utils/supabase/classes-service.ts,Ensure rules read from DB; show policy snippet on class + checkout; add cancel button with eligibility check and wallet refund path.
Self-service reschedule (move booking to another class before cutoff),Missing,/src/components/portal/pages/AccountDashboardPage.tsx; /src/components/portal/ClassDetailModal.tsx,/src/components/ClassesManagement.tsx; /src/components/RecurringClassManagement.tsx,Offer 'Change class' action; preserve credits; re-run capacity/waitlist checks.
Display prices and supported Abos/credits on class detail,Partially present,/src/components/portal/pages/ClassDetailPage.tsx; /src/components/portal/pages/PricingPage.tsx,/src/components/ProductsManagement.tsx; /src/utils/supabase/shop-service.ts,List accepted passes/credits; show price tiers; link to purchase flow.
Checkout: payment + wallet credits auto-apply + coupon,Present (verify),/src/components/portal/pages/CheckoutPage.tsx,/src/components/finance/OrdersPaymentsManagement.tsx; /src/utils/supabase/finance-service.ts,Auto-apply credits; coupon code input; edge-cases for mixed discount + credit.
Stripe Connect (no company) via YogaSwiss platform,Design decision,/src/components/portal/pages/CheckoutPage.tsx; /src/components/finance/SwissPaymentIntegration.tsx,/src/components/finance/FinanceManagement.tsx,"Implement Connect: charges on platform, payouts to instructors; add fees & T&Cs notice."
Waiver/Disclaimer gating on first booking (versioned consent),Partially present,/src/components/portal/pages/CheckoutPage.tsx; /src/components/portal/pages/CustomerOnboardingPage.tsx; /src/components/portal/pages/ProfileSettingsPage.tsx,/src/components/SettingsManagement.tsx,"Make acceptance mandatory; store version, timestamp, IP; show history & re-consent when updated."
Marketing preferences center + double opt-in,Partially present,/src/components/portal/pages/ProfileSettingsPage.tsx; /src/components/portal/pages/CustomerOnboardingPage.tsx,/src/components/marketing/CampaignManagement.tsx; /src/utils/supabase/marketing-service.ts,"Explicit checkboxes; trigger confirmation email; store consent provenance (timestamp, channel)."
Waitlist join/leave + auto-promotion rules surface in UI,Present (verify),/src/components/portal/ClassDetailModal.tsx; /src/components/portal/pages/ClassDetailPage.tsx,/src/components/WaitlistManagerDialog.tsx,Show current position; notify on promotion; enforce promotion payment rules.
"Order history, downloadable invoices/receipts",Missing/unclear,/src/components/portal/pages/AccountDashboardPage.tsx,/src/components/finance/OrdersPaymentsManagement.tsx,"List orders with PDF receipts; per order: items, VAT, payment method, refunds."
"Wallet: show balance, expiry, top-up flows",Present (verify),/src/components/core/CustomerWalletManager.tsx; /src/components/portal/pages/AccountDashboardPage.tsx; /src/components/portal/pages/PricingPage.tsx,/src/components/ProductsManagement.tsx; /src/utils/supabase/finance-service.ts,Show pass/credit status; allow top-up; pro-rate or extend validity where applicable.
Refund paths after cancellation (credit vs card),Partially present,/src/components/portal/pages/AccountDashboardPage.tsx,/src/components/finance/OrdersPaymentsManagement.tsx,Surface which refund applies; update wallet immediately; async card refunds info banner.
"Class-specific policies (outdoor weather, retreats)",Partially present,/src/components/portal/pages/OutdoorPage.tsx; /src/components/portal/pages/RetreatDetailPage.tsx; /src/components/portal/pages/RetreatCheckoutPage.tsx,/src/components/OutdoorLocationsManagement.tsx; /src/components/retreats/RetreatsManagement.tsx,Show weather fallback/credit rules; different cancellation windows and deposits.
Localized policy copy (FR/DE/EN) and email templates,Missing/unclear,/src/components/portal/pages/CheckoutPage.tsx; /src/components/portal/pages/ClassDetailPage.tsx,/src/components/communications/CommunicationsManagement.tsx,Load policy strings from DB per locale; ensure emails mirror the same policy text.
